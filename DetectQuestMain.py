# -*- coding: utf-8 -*-
"""Untitled4.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Y9MdeqLfnwNJ3qBgdrNKJqCQCClcZquF
"""

!pip install ultralytics
from ultralytics import YOLO
import random
import matplotlib.pyplot as plt
import cv2
from google.colab import files
import os

model = YOLO('yolov8n.pt')

def detect_and_show(image_path):
    results = model(image_path)
    res_img = results[0].plot()
    plt.imshow(cv2.cvtColor(res_img, cv2.COLOR_BGR2RGB))
    plt.axis("off")
    plt.show()
    names = model.names
    detected_classes = [names[int(box.cls)] for box in results[0].boxes]
    return detected_classes

score = 0
rounds = 3
target_classes = list(model.names.values())

for r in range(rounds):
    target = random.choice(target_classes)
    print(f"ç¬¬ {r+1} è½®: è¯·ä¸Šä¼ ä¸€å¼ åŒ…å« **{target}** çš„å›¾ç‰‡ï¼")

    uploaded = files.upload()
    img_path = list(uploaded.keys())[0]

    detected = detect_and_show(img_path)
    print("æ£€æµ‹ç»“æœï¼š", detected)

    if target in detected:
        score += 1
        print("âœ… æ­£ç¡®ï¼å¾—åˆ†+1")
    else:
        print("âŒ æ²¡æ‰¾åˆ°ç›®æ ‡")

    os.remove(img_path)

print(f"ğŸ‰ æ¸¸æˆç»“æŸï¼Œæ€»å¾—åˆ†: {score}/{rounds}")